{"ast":null,"code":"import _regeneratorRuntime from\"D:/reactPractice/create_react_app/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/reactPractice/create_react_app/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/reactPractice/create_react_app/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{Table,Image,Badge,Spinner}from'react-bootstrap';import axios from'axios';import{format}from'date-fns';import{th}from'date-fns/locale';import{BsEyeFill}from'react-icons/bs';import{Link}from\"react-router-dom\";import{addToCart}from'../redux/actions/cartAction';import{useSelector,useDispatch}from'react-redux';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ProductPage=function ProductPage(){var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),product=_React$useState2[0],setProduct=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),loading=_React$useState4[0],setLoading=_React$useState4[1];var _React$useState5=React.useState(null),_React$useState6=_slicedToArray(_React$useState5,2),error=_React$useState6[0],setError=_React$useState6[1];var cancelToken=React.useRef(null);var dispatch=useDispatch();var cartlist=useSelector(function(state){return state.cartReducer.cartlist;});var total=useSelector(function(state){return state.cartReducer.total;});var getData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setLoading(true);_context.next=4;return axios.get('https://api.codingthailand.com/api/course',{cancelToken:cancelToken.current.token});case 4:res=_context.sent;setProduct(res.data.data);_context.next=12;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.log(_context.t0);setError(_context.t0);case 12:_context.prev=12;setLoading(false);return _context.finish(12);case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,8,12,15]]);}));return function getData(){return _ref.apply(this,arguments);};}();React.useEffect(function(){cancelToken.current=axios.CancelToken.source();getData();return function(){// console.log('exit')\ncancelToken.current.cancel();};},[]);if(loading===true){return/*#__PURE__*/_jsx(\"div\",{className:\"text-center mt-5\",children:/*#__PURE__*/_jsx(Spinner,{animation:\"border\"})});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mt-5\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Have a problem from server,please try again.\"}),/*#__PURE__*/_jsx(\"p\",{children:error.response.data.message})]});}var addCart=function addCart(p){var product={id:p.id,name:p.title,price:p.view,qty:1};dispatch(addToCart(product,cartlist));};return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row mt-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-12\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Products\"}),total>0&&/*#__PURE__*/_jsxs(\"h4\",{children:[\"You chose a products for \",total]}),/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Course name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Course detail\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date create\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Views\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Picture\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:product.map(function(p,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:p.id}),/*#__PURE__*/_jsx(\"td\",{children:p.title}),/*#__PURE__*/_jsx(\"td\",{children:p.detail}),/*#__PURE__*/_jsx(\"td\",{children:format(new Date(p.date),'dd/MMM/yyyy',{locale:th})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Badge,{variant:\"secondary\",children:p.view})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Image,{src:p.picture,rounded:true,alt:p.title,width:100})}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(Link,{to:\"/detail/\".concat(p.id,\"/title/\").concat(p.title),children:/*#__PURE__*/_jsx(BsEyeFill,{})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-success ml-2\",onClick:function onClick(){return addCart(p);},children:\"Pick product\"})]})]},p.id);})})]})]})})});};export default ProductPage;","map":{"version":3,"sources":["D:/reactPractice/create_react_app/my-app/src/pages/ProductPage.js"],"names":["React","Table","Image","Badge","Spinner","axios","format","th","BsEyeFill","Link","addToCart","useSelector","useDispatch","ProductPage","useState","product","setProduct","loading","setLoading","error","setError","cancelToken","useRef","dispatch","cartlist","state","cartReducer","total","getData","get","current","token","res","data","console","log","useEffect","CancelToken","source","cancel","response","message","addCart","p","id","name","title","price","view","qty","map","index","detail","Date","date","locale","picture"],"mappings":"0dAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,KAAT,CAAgBC,KAAhB,CAAuBC,KAAvB,CAA8BC,OAA9B,KAA6C,iBAA7C,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,MAAT,KAAuB,UAAvB,CACA,OAASC,EAAT,KAAmB,iBAAnB,CACA,OAASC,SAAT,KAA0B,gBAA1B,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,OAASC,SAAT,KAA0B,6BAA1B,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,C,wFAEA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CAEtB,oBAA8Bb,KAAK,CAACc,QAAN,CAAe,EAAf,CAA9B,oDAAOC,OAAP,qBAAgBC,UAAhB,qBACA,qBAA8BhB,KAAK,CAACc,QAAN,CAAe,KAAf,CAA9B,qDAAOG,OAAP,qBAAgBC,UAAhB,qBACA,qBAA0BlB,KAAK,CAACc,QAAN,CAAe,IAAf,CAA1B,qDAAOK,KAAP,qBAAcC,QAAd,qBACA,GAAMC,CAAAA,WAAW,CAAGrB,KAAK,CAACsB,MAAN,CAAa,IAAb,CAApB,CAEA,GAAMC,CAAAA,QAAQ,CAAGX,WAAW,EAA5B,CACA,GAAMY,CAAAA,QAAQ,CAAGb,WAAW,CAAC,SAACc,KAAD,QAAWA,CAAAA,KAAK,CAACC,WAAN,CAAkBF,QAA7B,EAAD,CAA5B,CACA,GAAMG,CAAAA,KAAK,CAAGhB,WAAW,CAAC,SAACc,KAAD,QAAWA,CAAAA,KAAK,CAACC,WAAN,CAAkBC,KAA7B,EAAD,CAAzB,CAEA,GAAMC,CAAAA,OAAO,0FAAG,2JAERV,UAAU,CAAC,IAAD,CAAV,CAFQ,sBAGUb,CAAAA,KAAK,CAACwB,GAAN,CAAU,2CAAV,CAAsD,CACpER,WAAW,CAAEA,WAAW,CAACS,OAAZ,CAAoBC,KADmC,CAAtD,CAHV,QAGFC,GAHE,eAMRhB,UAAU,CAACgB,GAAG,CAACC,IAAJ,CAASA,IAAV,CAAV,CANQ,+EAQRC,OAAO,CAACC,GAAR,cACAf,QAAQ,aAAR,CATQ,yBAWRF,UAAU,CAAC,KAAD,CAAV,CAXQ,qGAAH,kBAAPU,CAAAA,OAAO,0CAAb,CAeA5B,KAAK,CAACoC,SAAN,CAAgB,UAAM,CAElBf,WAAW,CAACS,OAAZ,CAAsBzB,KAAK,CAACgC,WAAN,CAAkBC,MAAlB,EAAtB,CACAV,OAAO,GAEP,MAAO,WAAO,CACV;AACAP,WAAW,CAACS,OAAZ,CAAoBS,MAApB,GACH,CAHD,CAKH,CAVD,CAUE,EAVF,EAYA,GAAGtB,OAAO,GAAK,IAAf,CAAoB,CAChB,mBACI,YAAK,SAAS,CAAC,kBAAf,uBACI,KAAC,OAAD,EAAS,SAAS,CAAC,QAAnB,EADJ,EADJ,CAKH,CAED,GAAIE,KAAJ,CAAW,CACP,mBACI,aAAK,SAAS,CAAC,kBAAf,wBACI,mEADJ,cAEI,mBAAIA,KAAK,CAACqB,QAAN,CAAeP,IAAf,CAAoBQ,OAAxB,EAFJ,GADJ,CAMH,CAED,GAAMC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,CAACC,CAAD,CAAO,CAEnB,GAAM5B,CAAAA,OAAO,CAAG,CACZ6B,EAAE,CAAED,CAAC,CAACC,EADM,CAEZC,IAAI,CAAEF,CAAC,CAACG,KAFI,CAGZC,KAAK,CAAEJ,CAAC,CAACK,IAHG,CAIZC,GAAG,CAAE,CAJO,CAAhB,CAOA1B,QAAQ,CAACb,SAAS,CAACK,OAAD,CAASS,QAAT,CAAV,CAAR,CACH,CAVD,CAYA,mBACI,YAAK,SAAS,CAAC,WAAf,uBACI,YAAK,SAAS,CAAC,UAAf,uBACI,aAAK,SAAS,CAAC,WAAf,wBACI,gCADJ,CAGQG,KAAK,CAAG,CAAR,eAAa,kDAA8BA,KAA9B,GAHrB,cAKI,MAAC,KAAD,EAAO,OAAO,KAAd,CAAe,QAAQ,KAAvB,CAAwB,KAAK,KAA7B,wBACI,oCACI,mCACI,0BADJ,cAEI,mCAFJ,cAGI,qCAHJ,cAII,mCAJJ,cAKI,6BALJ,cAMI,+BANJ,cAOI,8BAPJ,GADJ,EADJ,cAYI,uBAEQZ,OAAO,CAACmC,GAAR,CAAY,SAACP,CAAD,CAAGQ,KAAH,CAAa,CACrB,mBACI,mCACI,oBAAKR,CAAC,CAACC,EAAP,EADJ,cAEI,oBAAKD,CAAC,CAACG,KAAP,EAFJ,cAGI,oBAAKH,CAAC,CAACS,MAAP,EAHJ,cAII,oBAEQ9C,MAAM,CAAC,GAAI+C,CAAAA,IAAJ,CAASV,CAAC,CAACW,IAAX,CAAD,CAAmB,aAAnB,CAAkC,CAACC,MAAM,CAAEhD,EAAT,CAAlC,CAFd,EAJJ,cASI,iCACI,KAAC,KAAD,EAAO,OAAO,CAAC,WAAf,UAA4BoC,CAAC,CAACK,IAA9B,EADJ,EATJ,cAYI,iCACI,KAAC,KAAD,EAAO,GAAG,CAAEL,CAAC,CAACa,OAAd,CAAuB,OAAO,KAA9B,CAA+B,GAAG,CAAEb,CAAC,CAACG,KAAtC,CAA6C,KAAK,CAAE,GAApD,EADJ,EAZJ,cAeI,mCACI,KAAC,IAAD,EAAM,EAAE,mBAAaH,CAAC,CAACC,EAAf,mBAA2BD,CAAC,CAACG,KAA7B,CAAR,uBACI,KAAC,SAAD,IADJ,EADJ,cAII,eAAQ,SAAS,CAAC,8BAAlB,CAAiD,OAAO,CAAE,yBAAMJ,CAAAA,OAAO,CAACC,CAAD,CAAb,EAA1D,0BAJJ,GAfJ,GAASA,CAAC,CAACC,EAAX,CADJ,CA0BH,CA3BD,CAFR,EAZJ,GALJ,GADJ,EADJ,EADJ,CAyDH,CA5HD,CA8HA,cAAe/B,CAAAA,WAAf","sourcesContent":["import React from 'react'\r\nimport { Table, Image, Badge, Spinner } from 'react-bootstrap'\r\nimport axios from 'axios'\r\nimport { format } from 'date-fns'\r\nimport { th } from 'date-fns/locale'\r\nimport { BsEyeFill } from 'react-icons/bs'\r\nimport { Link } from \"react-router-dom\";\r\nimport { addToCart } from '../redux/actions/cartAction'\r\nimport { useSelector, useDispatch } from 'react-redux'\r\n\r\nconst ProductPage = () => {\r\n\r\n    const [product, setProduct] = React.useState([])\r\n    const [loading, setLoading] = React.useState(false)\r\n    const [error, setError] = React.useState(null)\r\n    const cancelToken = React.useRef(null)\r\n\r\n    const dispatch = useDispatch()\r\n    const cartlist = useSelector((state) => state.cartReducer.cartlist)\r\n    const total = useSelector((state) => state.cartReducer.total)\r\n\r\n    const getData = async () => {\r\n        try {\r\n            setLoading(true)\r\n            const res = await axios.get('https://api.codingthailand.com/api/course',{\r\n                cancelToken: cancelToken.current.token  \r\n            })\r\n            setProduct(res.data.data)\r\n        } catch (error){\r\n            console.log(error)\r\n            setError(error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    React.useEffect(() => {\r\n\r\n        cancelToken.current = axios.CancelToken.source()\r\n        getData()\r\n\r\n        return () =>  {\r\n            // console.log('exit')\r\n            cancelToken.current.cancel()\r\n        }\r\n\r\n    },[])\r\n\r\n    if(loading === true){\r\n        return(\r\n            <div className=\"text-center mt-5\">\r\n                <Spinner animation=\"border\" />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    if (error) {\r\n        return (\r\n            <div className=\"text-center mt-5\">\r\n                <p>Have a problem from server,please try again.</p>\r\n                <p>{error.response.data.message}</p>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    const addCart = (p) => {\r\n\r\n        const product = {\r\n            id: p.id,\r\n            name: p.title,\r\n            price: p.view,\r\n            qty: 1\r\n        }\r\n\r\n        dispatch(addToCart(product,cartlist))\r\n    }\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <div className=\"row mt-5\">\r\n                <div className=\"col-md-12\">\r\n                    <h2>Products</h2>\r\n                    {\r\n                        total > 0 && <h4>You chose a products for {total}</h4>\r\n                    }\r\n                    <Table striped bordered hover>\r\n                        <thead>\r\n                            <tr>\r\n                                <th>ID</th>\r\n                                <th>Course name</th>\r\n                                <th>Course detail</th>\r\n                                <th>Date create</th>\r\n                                <th>Views</th>\r\n                                <th>Picture</th>\r\n                                <th>Action</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {\r\n                                product.map((p,index) => {\r\n                                    return (\r\n                                        <tr key={p.id}>\r\n                                            <td>{p.id}</td>\r\n                                            <td>{p.title}</td>\r\n                                            <td>{p.detail}</td>\r\n                                            <td>\r\n                                                {\r\n                                                    format(new Date(p.date), 'dd/MMM/yyyy', {locale: th})\r\n                                                }\r\n                                            </td>\r\n                                            <td>\r\n                                                <Badge variant=\"secondary\">{p.view}</Badge>\r\n                                            </td>\r\n                                            <td>\r\n                                                <Image src={p.picture} rounded alt={p.title} width={100} />\r\n                                            </td>\r\n                                            <td>\r\n                                                <Link to={`/detail/${p.id}/title/${p.title}`}>\r\n                                                    <BsEyeFill/>\r\n                                                </Link>\r\n                                                <button className=\"btn btn-outline-success ml-2\" onClick={() => addCart(p)}>\r\n                                                    Pick product\r\n                                                </button>\r\n                                            </td>\r\n                                        </tr>\r\n                                    )\r\n                                })\r\n                            }\r\n                        </tbody>\r\n                    </Table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ProductPage\r\n"]},"metadata":{},"sourceType":"module"}