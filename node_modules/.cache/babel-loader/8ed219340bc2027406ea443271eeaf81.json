{"ast":null,"code":"import _regeneratorRuntime from\"D:/reactPractice/create_react_app/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/reactPractice/create_react_app/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/reactPractice/create_react_app/my-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import axios from'axios';import{Spinner,Table,Button}from'react-bootstrap';import{FiEdit,FiTrash2}from\"react-icons/fi\";import{useHistory}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var IndexPage=function IndexPage(){var _React$useState=React.useState([]),_React$useState2=_slicedToArray(_React$useState,2),category=_React$useState2[0],setCategory=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),loading=_React$useState4[0],setLoading=_React$useState4[1];var _React$useState5=React.useState(null),_React$useState6=_slicedToArray(_React$useState5,2),error=_React$useState6[0],setError=_React$useState6[1];var cancelToken=React.useRef(null);var history=useHistory();var getData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setLoading(true);_context.next=4;return axios.get(\"https://api.codingthailand.com/api/category\",{cancelToken:cancelToken.current.token});case 4:res=_context.sent;setCategory(res.data);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);setError(_context.t0);case 11:_context.prev=11;setLoading(false);return _context.finish(11);case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,8,11,14]]);}));return function getData(){return _ref.apply(this,arguments);};}();React.useEffect(function(){cancelToken.current=axios.CancelToken.source();getData();return function(){cancelToken.current.cancel();};},[]);if(loading===true){return/*#__PURE__*/_jsx(\"div\",{className:\"text-center mt-5\",children:/*#__PURE__*/_jsx(Spinner,{animation:\"border\"})});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mt-5\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Have a problem from server,please try again.\"}),/*#__PURE__*/_jsx(\"p\",{children:error.response.data.message})]});}return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row mt-5\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-12\",children:[/*#__PURE__*/_jsx(Button,{className:\"mt-3 mb-3\",variant:\"success\",onClick:function onClick(){return history.push('/category/create');},children:\"Add Category\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Category Lists\"}),/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,className:\"mt-4\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Category Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:category.map(function(c,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:c.id}),/*#__PURE__*/_jsx(\"td\",{children:c.name}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(Button,{className:\"ml-2\",variant:\"outline-info\",size:\"sm\",onClick:function onClick(){return history.push('/category/edit/'+c.id);},children:/*#__PURE__*/_jsx(FiEdit,{})}),/*#__PURE__*/_jsx(Button,{className:\"ml-2\",variant:\"outline-danger\",size:\"sm\",onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var isConfirm,res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:isConfirm=window.confirm('Are you sure to delete '+c.name+' ?');if(!(isConfirm===true)){_context2.next=7;break;}_context2.next=4;return axios.delete('https://api.codingthailand.com/api/category/'+c.id);case 4:res=_context2.sent;alert(res.data.message);history.go(0);case 7:case\"end\":return _context2.stop();}}},_callee2);})),children:/*#__PURE__*/_jsx(FiTrash2,{})})]})]},c.id);})})]}),/*#__PURE__*/_jsx(\"br\",{})]})})});};export default IndexPage;","map":{"version":3,"sources":["D:/reactPractice/create_react_app/my-app/src/pages/category/IndexPage.js"],"names":["React","axios","Spinner","Table","Button","FiEdit","FiTrash2","useHistory","IndexPage","useState","category","setCategory","loading","setLoading","error","setError","cancelToken","useRef","history","getData","get","current","token","res","data","useEffect","CancelToken","source","cancel","response","message","push","map","c","index","id","name","isConfirm","window","confirm","delete","alert","go"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport axios from 'axios'\r\nimport { Spinner, Table, Button } from 'react-bootstrap'\r\nimport { FiEdit, FiTrash2 } from \"react-icons/fi\";\r\nimport { useHistory } from 'react-router-dom'\r\n\r\nconst IndexPage = () => {\r\n\r\n    const [category, setCategory] = React.useState([])\r\n    const [loading, setLoading] = React.useState(false)\r\n    const [error, setError] = React.useState(null)\r\n    const cancelToken = React.useRef(null)\r\n    const history = useHistory()\r\n\r\n    const getData = async () => {\r\n        try {\r\n            setLoading(true)\r\n            const res = await axios.get(\r\n                `https://api.codingthailand.com/api/category`,\r\n                {\r\n                    cancelToken: cancelToken.current.token  \r\n                }\r\n            )\r\n            setCategory(res.data)\r\n        } catch (error){\r\n            setError(error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    React.useEffect(() => {\r\n\r\n        cancelToken.current = axios.CancelToken.source()\r\n        getData()\r\n\r\n        return () =>  {\r\n            cancelToken.current.cancel()\r\n        }\r\n\r\n    },[])\r\n\r\n    if(loading === true){\r\n        return(\r\n            <div className=\"text-center mt-5\">\r\n                <Spinner animation=\"border\" />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    if (error) {\r\n        return (\r\n            <div className=\"text-center mt-5\">\r\n                <p>Have a problem from server,please try again.</p>\r\n                <p>{error.response.data.message}</p>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <div className=\"row mt-5\">\r\n                <div className=\"col-md-12\">\r\n\r\n                    <Button className=\"mt-3 mb-3\" variant=\"success\" onClick={() => history.push('/category/create')}>Add Category</Button>\r\n\r\n                    <h2>Category Lists</h2>\r\n\r\n                    <Table striped bordered hover className=\"mt-4\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th>ID</th>\r\n                                <th>Category Name</th>\r\n                                <th>Actions</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {\r\n                               category.map((c, index) => {\r\n                                    return (\r\n                                        <tr key={c.id}>\r\n                                            <td>{c.id}</td>\r\n                                            <td>{c.name}</td>\r\n                                            <td>\r\n                                                <Button \r\n                                                    className=\"ml-2\" \r\n                                                    variant=\"outline-info\" \r\n                                                    size=\"sm\"\r\n                                                    onClick={() => history.push('/category/edit/' + c.id)}\r\n                                                >\r\n                                                    <FiEdit />\r\n                                                </Button>\r\n                                                <Button \r\n                                                    className=\"ml-2\" \r\n                                                    variant=\"outline-danger\" \r\n                                                    size=\"sm\"\r\n                                                    onClick={async () => {\r\n\r\n                                                        const isConfirm = window.confirm('Are you sure to delete ' + c.name + ' ?')\r\n\r\n                                                        if(isConfirm === true){\r\n                                                            const res = await axios.delete('https://api.codingthailand.com/api/category/' + c.id)\r\n                                                            alert(res.data.message)\r\n                                                            history.go(0)\r\n                                                        }\r\n                                                    }}\r\n                                                >\r\n                                                    <FiTrash2 />\r\n                                                </Button>\r\n                                            </td>\r\n                                        </tr>\r\n                                    )\r\n                               }) \r\n                            }\r\n                        </tbody>\r\n                    </Table>\r\n                    <br />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default IndexPage\r\n"]},"metadata":{},"sourceType":"module"}